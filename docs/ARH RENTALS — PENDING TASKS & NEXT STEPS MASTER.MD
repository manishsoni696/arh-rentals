ğŸ” ARH RENTALS â€” MASTER TASKS & STATUS (v7.2)

Last Updated: Jan 10, 2026
Scope: Post Property (Owner) + Dashboard + Backend
âŒ Listings / Pricing / Demo / Business wording untouched

ğŸ§± GLOBAL STATUS (NON-NEGOTIABLE)

âœ… Static Frontend (GitHub Pages)

âœ… Backend: Cloudflare Workers (native only)

ğŸ”’ Core Auth / Pricing / Legal â€” LOCKED

ğŸ”’ Responsive (Desktop + Tablet + Mobile) â€” MANDATORY

ğŸ” AUTH & SESSION (GLOBAL) â€” ğŸ”’ LOCKED
âœ… COMPLETED

PIN â†’ OTP flow stable

OTP via button + Enter key

Logged-in state in GLOBAL HEADER

Masked phone shown

Header dropdown active immediately

Logout only via header

Protected routes enforce redirect

ğŸ”’ OTP UX â€” FINAL

OTP resend timer phone-number scoped

Phone change â†’ timer reset instantly

Refresh â†’ timer persists only for same number

âŒ No stuck timer

âŒ No global bleed

ğŸŸ¡ POST PROPERTY (OWNER) â€” FRONTEND
STATUS: IN PROGRESS
âœ… CONFIRMED & LOCKED

PIN verify ke baad hi form unlock

OTP PIN ke baad hi maanga jata hai

Core auth untouched

Logout resets:

PIN, Phone, OTP cleared

Form locked

Draft retained

ğŸ“ POST PROPERTY MODULE â€” ğŸ”’ STRUCTURE LOCKED

/post/index.html

HTML skeleton + markup only

âŒ No inline JS

/assets/post-property.js

Single source:

Form logic

Amenities render

Photo validation

Submit

Cloud draft UI logic

âŒ Core auth touch nahi karega

/assets/styles.css

.post-page {} scoped only

Pricing FINAL LOCK untouched

ğŸŸ¡ FRONTEND â€” PENDING (ONLY THESE)

âŒ Remove remaining inline JS from /post/index.html

âŒ Amenities reuse FINAL Listings Filters amenities

âŒ Add <body class="post-page">

âŒ City hard-lock = Hisar

âŒ Property Type enums (backend-safe) + friendly labels

ğŸŸ¢ DASHBOARD â€” UI
STATUS: COMPLETED & ğŸ”’ LOCKED

UI upgraded

Subtitle locked:

â€œAccess and manage rental listings linked to this mobile number.â€

No UI changes allowed

â˜ï¸ CLOUD DRAFT â€” ğŸ”’ FINALIZED FEATURE
âœ… COMPLETED & LOCKED

Rules

Save allowed only after PIN + OTP

Identity = logged-in mobile

1 draft per mobile

Storage = Cloudflare D1

Retention = 3 days (auto-expiry)

Logout does NOT delete draft

ğŸ”„ Restore Flow

PIN â†’ OTP â†’ draft check
Draft found â†’ Restore / Discard
No draft â†’ normal form

ğŸ§¾ CLOUD DRAFT â€” TECH (LOCKED REFERENCE)
D1 Table: drafts

mobile

draft_json

updated_at

expires_at

Indexes:

idx_drafts_mobile

idx_drafts_expires

ğŸŒ BACKEND â€” WORKERS
ğŸ”’ ARCHITECTURE LOCKED

Cloudflare Workers ONLY

âŒ No Express / Node

D1 + R2 only

ğŸŸ  BACKEND PHASE-1 â€” IN PROGRESS
Photo Upload (NO Compression)

/api/uploads/init â†’ presigned

Direct R2 upload

/api/listings/create

Server re-validation

Partial fail â†’ listing NOT created

âŒ Compression NOT allowed

ğŸŸ  BACKEND PHASE-1B â€” IN PROGRESS
Cloud Draft APIs

/api/drafts/save

/api/drafts/latest

/api/drafts/delete

Auto-cleanup after 3 days

ğŸ”’ PHASE-2 (LATER)

Image compression (~500KB)

âŒ Do not implement now

ğŸ” CLOUDFARE WORKERS â€” LOCKED COMPONENTS
ğŸ”’ Worker: arh-dashboard

URL: https://arh-dashboard.manishsoni696.workers.dev

Purpose: Dashboard + Draft APIs

âŒ Not default API base unless explicitly allowed

ğŸ”’ Worker: arh-backend

Allowed in CSP

Primary backend API

ğŸ” SECURITY (LOCKED)
CSP

connect-src allows:

arh-backend

arh-dashboard

CORS

Dynamic origin allowlist

All jsonResponse() updated

ğŸ•’ AUTO-LOGOUT â€” ğŸ”’ DECISION LOCKED
OPTION-2 (FINAL)

Frontend: lastActivityAt (localStorage)

Backend: token expiry (Workers)

Browser close â†’ next open = immediate logout

âŒ No popups / alerts

Silent logout only

ğŸ“Š SESSION TRACKING â€” ACTIVE

sessions table exists in D1

Backend can check:

Active sessions

Logout time

Expired sessions

Last seen

(SQL queries already verified)

â³ PLANNED (AFTER FRONTEND FINALIZE)

Post Property field changes

Local draft autosave

Draft versioning

Draft photo preview

Admin session dashboard

âœ… FINAL CONFIRMATIONS â€” ğŸ”’ LOCKED

âŒ No business wording change

âŒ No listings / filters / demo change

âŒ No core auth change

âœ… Scoped CSS safe

âœ… Modular architecture stable
